<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/.streamlit/secrets.toml.example">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/.streamlit/secrets.toml.example" />
              <option name="originalContent" value="# Streamlit Secrets Template&#10;# Copy this file to secrets.toml and fill in your actual values&#10;# Never commit secrets.toml to version control!&#10;#&#10;# NOTE: For local development, it's recommended to use .env file instead&#10;# This file is only needed for Streamlit Cloud deployment&#10;&#10;SUPABASE_URL = &quot;your_supabase_url_here&quot;&#10;SUPABASE_SERVICE_ROLE_KEY = &quot;your_supabase_service_role_key_here&quot;" />
              <option name="updatedContent" value="# Streamlit Secrets Template&#10;# Copy this file to secrets.toml and fill in your actual values&#10;# Never commit secrets.toml to version control!&#10;#&#10;# NOTE: For local development, it's recommended to use .env file instead&#10;# This file is only needed for Streamlit Cloud deployment&#10;&#10;SUPABASE_URL = &quot;your_supabase_url_here&quot;&#10;SUPABASE_SERVICE_ROLE_KEY = &quot;your_supabase_service_role_key_here&quot;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/README.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/README.md" />
              <option name="originalContent" value="# nobounce-be&#10;No Bounce BE&#10;" />
              <option name="updatedContent" value="# nobounce-be&#10;No Bounce BE&#10;&#10;## Setup&#10;&#10;### 1. Install dependencies&#10;&#10;```bash&#10;uv sync&#10;```&#10;&#10;### 2. Configure secrets&#10;&#10;**For local development (Recommended):**&#10;&#10;Create a `.env` file in the root directory:&#10;&#10;```bash&#10;cp .env.example .env&#10;```&#10;&#10;Then edit `.env` and add your credentials:&#10;&#10;```&#10;SUPABASE_URL=https://your-project.supabase.co&#10;SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here&#10;```&#10;&#10;**For Streamlit Cloud deployment:**&#10;&#10;Create `.streamlit/secrets.toml` (for cloud deployment only):&#10;&#10;```bash&#10;cp .streamlit/secrets.toml.example .streamlit/secrets.toml&#10;```&#10;&#10;Then edit `.streamlit/secrets.toml` with your credentials.&#10;&#10;### 3. Run the app&#10;&#10;```bash&#10;uv run streamlit run main.py&#10;```&#10;&#10;## Security Notes&#10;&#10;- ⚠️ **Never commit `.env` or `.streamlit/secrets.toml` to version control**&#10;- The app will automatically load credentials from `.env` file first&#10;- If `.env` is not found, it will fall back to `.streamlit/secrets.toml`&#10;- For production deployments, use environment variables or Streamlit Cloud secrets" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/assets/README.md">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/assets/README.md" />
              <option name="updatedContent" value="# Assets Folder&#10;&#10;Place your No Bounce logo here as `logo.png` (or `logo.jpg`, `logo.svg`)&#10;&#10;The logo will be displayed on the Home page of the admin panel.&#10;&#10;Recommended size: 200-400px width for optimal display.&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/pages/01_Adicionar.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/pages/01_Adicionar.py" />
              <option name="originalContent" value="import streamlit as st&#10;import sys&#10;from pathlib import Path&#10;&#10;# Add parent directory to path&#10;sys.path.append(str(Path(__file__).parent.parent))&#10;from utils import (&#10;    get_supabase_client,&#10;    fetch_courts,&#10;    court_label,&#10;    parse_float_or_none,&#10;    upload_images_to_storage&#10;)&#10;&#10;st.set_page_config(page_title=&quot;Adicionar Campos &amp; Ratings&quot;, layout=&quot;wide&quot;)&#10;&#10;# Check authentication&#10;if not st.session_state.get(&quot;authentication_status&quot;):&#10;    st.error(&quot;Fazer login primeiro.&quot;)&#10;    st.stop()&#10;&#10;st.title(&quot;➕ Adicionar Campos &amp; Ratings&quot;)&#10;st.caption(&quot;ATENÇÃO: qualquer adição feita aqui é visível na aplicação.&quot;)&#10;&#10;# Get Supabase client&#10;sb = get_supabase_client()&#10;&#10;# -----------------------&#10;# Tabs&#10;# -----------------------&#10;tab1, tab2 = st.tabs([&quot;Adicionar Campo&quot;, &quot;Adicionar Rating&quot;])&#10;&#10;# =======================&#10;# TAB 1: Add Court&#10;# =======================&#10;with tab1:&#10;    st.subheader(&quot;Adicionar Campo&quot;)&#10;&#10;    with st.form(&quot;add_court_form&quot;):&#10;        col1, col2 = st.columns(2)&#10;&#10;        with col1:&#10;            name_in = st.text_input(&quot;Nome *&quot;)&#10;            address_in = st.text_input(&quot;Morada&quot;)&#10;            city_in = st.text_input(&quot;Concelho&quot;)&#10;            district_in = st.text_input(&quot;Distrito&quot;)&#10;&#10;        with col2:&#10;            lat_in = st.text_input(&quot;Latitude (optional)&quot;)&#10;            lon_in = st.text_input(&quot;Longitude (optional)&quot;)&#10;            insta_in = st.text_input(&quot;Instagram URL (optional)&quot;)&#10;            tiktok_in = st.text_input(&quot;TikTok URL (optional)&quot;)&#10;&#10;        uploaded_files = st.file_uploader(&quot;Upload de Imagens do Campo&quot;, type=[&quot;jpg&quot;, &quot;jpeg&quot;, &quot;png&quot;], accept_multiple_files=True)&#10;&#10;        submitted = st.form_submit_button(&quot;Criar Campo&quot;)&#10;&#10;    if submitted:&#10;        if not name_in.strip():&#10;            st.error(&quot;Nome é obrigatório.&quot;)&#10;            st.stop()&#10;&#10;        admin_email = st.session_state.get('username')&#10;&#10;        try:&#10;            payload = {&#10;                &quot;name&quot;: name_in.strip(),&#10;                &quot;address&quot;: address_in.strip() if address_in.strip() else None,&#10;                &quot;city&quot;: city_in.strip() if city_in.strip() else None,&#10;                &quot;district&quot;: district_in.strip() if district_in.strip() else None,&#10;                &quot;latitude&quot;: parse_float_or_none(lat_in),&#10;                &quot;longitude&quot;: parse_float_or_none(lon_in),&#10;                &quot;instagram_url&quot;: insta_in.strip() if insta_in.strip() else None,&#10;                &quot;tiktok_url&quot;: tiktok_in.strip() if tiktok_in.strip() else None,&#10;                &quot;image_urls&quot;: [],&#10;                &quot;admin_created_by&quot;: admin_email,&#10;            }&#10;        except ValueError as e:&#10;            st.error(f&quot;Latitude/Longitude tem que ser numéros válidos: {e}&quot;)&#10;            st.stop()&#10;&#10;        try:&#10;            result = sb.table(&quot;courts&quot;).insert(payload).execute()&#10;            court_data = result.data[0] if result.data else None&#10;&#10;            if not court_data:&#10;                st.error(&quot;Erro na criação do campo&quot;)&#10;                st.stop()&#10;&#10;            court_id = court_data['id']&#10;&#10;            if uploaded_files:&#10;                with st.spinner(f&quot;Uploading {len(uploaded_files)} image(s)...&quot;):&#10;                    image_urls = upload_images_to_storage(sb, uploaded_files, court_id)&#10;&#10;                    if image_urls:&#10;                        sb.table(&quot;courts&quot;).update({&quot;image_urls&quot;: image_urls}).eq(&quot;id&quot;, court_id).execute()&#10;                        st.success(f&quot;Campo criado ✅ (ID: {court_id}) com {len(image_urls)} imagem(nes)&quot;)&#10;                    else:&#10;                        st.success(f&quot;Campo criado ✅ (ID: {court_id}) sem images&quot;)&#10;            else:&#10;                st.success(f&quot;Campo criado ✅ (ID: {court_id})&quot;)&#10;        except Exception as e:&#10;            st.error(f&quot;Erro em criar o Campo: {e}&quot;)&#10;&#10;# =======================&#10;# TAB 2: Add Court Rating&#10;# =======================&#10;with tab2:&#10;    st.subheader(&quot;Adicionar Rating (No Bounce)&quot;)&#10;&#10;    courts = fetch_courts(sb)&#10;    if not courts:&#10;        st.warning(&quot;Não foram encontrados campos&quot;)&#10;        st.stop()&#10;&#10;    labels = [court_label(c) for c in courts]&#10;    label_to_id = {court_label(c): c[&quot;id&quot;] for c in courts}&#10;&#10;    with st.form(&quot;add_rating_form&quot;):&#10;        selected = st.selectbox(&quot;Campo *&quot;, labels)&#10;        court_id = label_to_id[selected]&#10;&#10;        colA, colB, colC = st.columns(3)&#10;&#10;        with colA:&#10;            overall = st.number_input(&quot;Overall (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            rim = st.number_input(&quot;Aro (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            floor = st.number_input(&quot;Chão (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;&#10;        with colB:&#10;            court_spacing = st.number_input(&quot;Espaço (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            bench = st.number_input(&quot;Banco (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            water = st.number_input(&quot;Água (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;&#10;        with colC:&#10;            backboard = st.number_input(&quot;Tabela (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            source = st.selectbox(&quot;Fonte&quot;, [&quot;NO_BOUNCE&quot;], index=0)&#10;&#10;        submitted = st.form_submit_button(&quot;Criar Rating&quot;)&#10;&#10;    if submitted:&#10;        admin_email = st.session_state.get('username')&#10;&#10;        payload = {&#10;            &quot;court_id&quot;: court_id,&#10;            &quot;source&quot;: source,&#10;            &quot;overall&quot;: round(float(overall), 2),&#10;            &quot;rim&quot;: round(float(rim), 2),&#10;            &quot;floor&quot;: round(float(floor), 2),&#10;            &quot;court_spacing&quot;: round(float(court_spacing), 2),&#10;            &quot;bench&quot;: round(float(bench), 2),&#10;            &quot;water&quot;: round(float(water), 2),&#10;            &quot;backboard&quot;: round(float(backboard), 2),&#10;            &quot;admin_created_by&quot;: admin_email,&#10;        }&#10;&#10;        try:&#10;            sb.table(&quot;court_ratings&quot;).upsert(payload, on_conflict=&quot;court_id,source&quot;).execute()&#10;            st.success(&quot;Rating criado ✅&quot;)&#10;        except Exception as e:&#10;            st.error(f&quot;Erro ao criar rating: {e}&quot;)&#10;" />
              <option name="updatedContent" value="import streamlit as st&#10;import sys&#10;from pathlib import Path&#10;&#10;# Add parent directory to path&#10;sys.path.append(str(Path(__file__).parent.parent))&#10;from utils import (&#10;    get_supabase_client,&#10;    fetch_courts,&#10;    court_label,&#10;    parse_float_or_none,&#10;    upload_images_to_storage&#10;)&#10;&#10;st.set_page_config(page_title=&quot;Adicionar Campos &amp; Ratings&quot;, layout=&quot;wide&quot;, page_icon=&quot;&quot;)&#10;&#10;# Check authentication&#10;if not st.session_state.get(&quot;authentication_status&quot;):&#10;    st.error(&quot;Fazer login primeiro.&quot;)&#10;    st.stop()&#10;&#10;st.title(&quot;➕ Adicionar Campos &amp; Ratings&quot;)&#10;st.caption(&quot;ATENÇÃO: qualquer adição feita aqui é visível na aplicação.&quot;)&#10;&#10;# Get Supabase client&#10;sb = get_supabase_client()&#10;&#10;# -----------------------&#10;# Tabs&#10;# -----------------------&#10;tab1, tab2 = st.tabs([&quot;Adicionar Campo&quot;, &quot;Adicionar Rating&quot;])&#10;&#10;# =======================&#10;# TAB 1: Add Court&#10;# =======================&#10;with tab1:&#10;    st.subheader(&quot;Adicionar Campo&quot;)&#10;&#10;    with st.form(&quot;add_court_form&quot;):&#10;        col1, col2 = st.columns(2)&#10;&#10;        with col1:&#10;            name_in = st.text_input(&quot;Nome *&quot;)&#10;            address_in = st.text_input(&quot;Morada&quot;)&#10;            city_in = st.text_input(&quot;Concelho&quot;)&#10;            district_in = st.text_input(&quot;Distrito&quot;)&#10;&#10;        with col2:&#10;            lat_in = st.text_input(&quot;Latitude (optional)&quot;)&#10;            lon_in = st.text_input(&quot;Longitude (optional)&quot;)&#10;            insta_in = st.text_input(&quot;Instagram URL (optional)&quot;)&#10;            tiktok_in = st.text_input(&quot;TikTok URL (optional)&quot;)&#10;&#10;        uploaded_files = st.file_uploader(&quot;Upload de Imagens do Campo&quot;, type=[&quot;jpg&quot;, &quot;jpeg&quot;, &quot;png&quot;], accept_multiple_files=True)&#10;&#10;        submitted = st.form_submit_button(&quot;Criar Campo&quot;)&#10;&#10;    if submitted:&#10;        if not name_in.strip():&#10;            st.error(&quot;Nome é obrigatório.&quot;)&#10;            st.stop()&#10;&#10;        admin_email = st.session_state.get('username')&#10;&#10;        try:&#10;            payload = {&#10;                &quot;name&quot;: name_in.strip(),&#10;                &quot;address&quot;: address_in.strip() if address_in.strip() else None,&#10;                &quot;city&quot;: city_in.strip() if city_in.strip() else None,&#10;                &quot;district&quot;: district_in.strip() if district_in.strip() else None,&#10;                &quot;latitude&quot;: parse_float_or_none(lat_in),&#10;                &quot;longitude&quot;: parse_float_or_none(lon_in),&#10;                &quot;instagram_url&quot;: insta_in.strip() if insta_in.strip() else None,&#10;                &quot;tiktok_url&quot;: tiktok_in.strip() if tiktok_in.strip() else None,&#10;                &quot;image_urls&quot;: [],&#10;                &quot;admin_created_by&quot;: admin_email,&#10;            }&#10;        except ValueError as e:&#10;            st.error(f&quot;Latitude/Longitude tem que ser numéros válidos: {e}&quot;)&#10;            st.stop()&#10;&#10;        try:&#10;            result = sb.table(&quot;courts&quot;).insert(payload).execute()&#10;            court_data = result.data[0] if result.data else None&#10;&#10;            if not court_data:&#10;                st.error(&quot;Erro na criação do campo&quot;)&#10;                st.stop()&#10;&#10;            court_id = court_data['id']&#10;&#10;            if uploaded_files:&#10;                with st.spinner(f&quot;Uploading {len(uploaded_files)} image(s)...&quot;):&#10;                    image_urls = upload_images_to_storage(sb, uploaded_files, court_id)&#10;&#10;                    if image_urls:&#10;                        sb.table(&quot;courts&quot;).update({&quot;image_urls&quot;: image_urls}).eq(&quot;id&quot;, court_id).execute()&#10;                        st.success(f&quot;Campo criado ✅ (ID: {court_id}) com {len(image_urls)} imagem(nes)&quot;)&#10;                    else:&#10;                        st.success(f&quot;Campo criado ✅ (ID: {court_id}) sem images&quot;)&#10;            else:&#10;                st.success(f&quot;Campo criado ✅ (ID: {court_id})&quot;)&#10;        except Exception as e:&#10;            st.error(f&quot;Erro em criar o Campo: {e}&quot;)&#10;&#10;# =======================&#10;# TAB 2: Add Court Rating&#10;# =======================&#10;with tab2:&#10;    st.subheader(&quot;Adicionar Rating (No Bounce)&quot;)&#10;&#10;    courts = fetch_courts(sb)&#10;    if not courts:&#10;        st.warning(&quot;Não foram encontrados campos&quot;)&#10;        st.stop()&#10;&#10;    labels = [court_label(c) for c in courts]&#10;    label_to_id = {court_label(c): c[&quot;id&quot;] for c in courts}&#10;&#10;    with st.form(&quot;add_rating_form&quot;):&#10;        selected = st.selectbox(&quot;Campo *&quot;, labels)&#10;        court_id = label_to_id[selected]&#10;&#10;        colA, colB, colC = st.columns(3)&#10;&#10;        with colA:&#10;            overall = st.number_input(&quot;Overall (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            rim = st.number_input(&quot;Aro (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            floor = st.number_input(&quot;Chão (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;&#10;        with colB:&#10;            court_spacing = st.number_input(&quot;Espaço (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            bench = st.number_input(&quot;Banco (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            water = st.number_input(&quot;Água (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;&#10;        with colC:&#10;            backboard = st.number_input(&quot;Tabela (0-10)&quot;, 0.0, 10.0, 0.0, step=0.25, format=&quot;%.2f&quot;)&#10;            source = st.selectbox(&quot;Fonte&quot;, [&quot;NO_BOUNCE&quot;], index=0)&#10;&#10;        submitted = st.form_submit_button(&quot;Criar Rating&quot;)&#10;&#10;    if submitted:&#10;        admin_email = st.session_state.get('username')&#10;&#10;        payload = {&#10;            &quot;court_id&quot;: court_id,&#10;            &quot;source&quot;: source,&#10;            &quot;overall&quot;: round(float(overall), 2),&#10;            &quot;rim&quot;: round(float(rim), 2),&#10;            &quot;floor&quot;: round(float(floor), 2),&#10;            &quot;court_spacing&quot;: round(float(court_spacing), 2),&#10;            &quot;bench&quot;: round(float(bench), 2),&#10;            &quot;water&quot;: round(float(water), 2),&#10;            &quot;backboard&quot;: round(float(backboard), 2),&#10;            &quot;admin_created_by&quot;: admin_email,&#10;        }&#10;&#10;        try:&#10;            sb.table(&quot;court_ratings&quot;).upsert(payload, on_conflict=&quot;court_id,source&quot;).execute()&#10;            st.success(&quot;Rating criado ✅&quot;)&#10;        except Exception as e:&#10;            st.error(f&quot;Erro ao criar rating: {e}&quot;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/pyproject.toml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/pyproject.toml" />
              <option name="originalContent" value="[project]&#10;name = &quot;streamlit_app&quot;&#10;version = &quot;0.1.0&quot;&#10;description = &quot;Add your description here&quot;&#10;readme = &quot;README.md&quot;&#10;requires-python = &quot;&gt;=3.11&quot;&#10;dependencies = [&#10;    &quot;python-dotenv&gt;=1.0.0&quot;,&#10;    &quot;streamlit&gt;=1.53.0&quot;,&#10;    &quot;streamlit-authenticator&gt;=0.4.2&quot;,&#10;    &quot;supabase&gt;=2.27.2&quot;,&#10;    &quot;watchdog&gt;=6.0.0&quot;,&#10;]&#10;" />
              <option name="updatedContent" value="[project]&#10;name = &quot;streamlit_app&quot;&#10;version = &quot;0.1.0&quot;&#10;description = &quot;Add your description here&quot;&#10;readme = &quot;README.md&quot;&#10;requires-python = &quot;&gt;=3.11&quot;&#10;dependencies = [&#10;    &quot;python-dotenv&gt;=1.0.0&quot;,&#10;    &quot;streamlit&gt;=1.53.0&quot;,&#10;    &quot;streamlit-authenticator&gt;=0.4.2&quot;,&#10;    &quot;supabase&gt;=2.27.2&quot;,&#10;    &quot;watchdog&gt;=6.0.0&quot;,&#10;]" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>